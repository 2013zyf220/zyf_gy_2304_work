source("E:/zyf_gy/zyf_gy_2304_work/tool_codes/R_lesson_youtube_2023a/第1讲 初始R studio.R")
source("E:/zyf_gy/zyf_gy_2304_work/tool_codes/R_lesson_youtube_2023a/第1讲 初始R studio.R")
source("E:/zyf_gy/zyf_gy_2304_work/tool_codes/R_lesson_youtube_2023a/第1讲 初始R studio.R")
View(data_1_tail)
source("E:/zyf_gy/zyf_gy_2304_work/tool_codes/R_lesson_youtube_2023a/第1讲 初始R studio.R")
source("E:/zyf_gy/zyf_gy_2304_work/tool_codes/R_lesson_youtube_2023a/第1讲 初始R studio.R")
source("E:/zyf_gy/zyf_gy_2304_work/tool_codes/R_lesson_youtube_2023a/第1讲 初始R studio.R")
source("E:/zyf_gy/zyf_gy_2304_work/tool_codes/R_lesson_youtube_2023a/第2讲 简单线性回归.R")
source("E:/zyf_gy/zyf_gy_2304_work/tool_codes/R_lesson_youtube_2023a/第2讲 简单线性回归.R")
source("E:/zyf_gy/zyf_gy_2304_work/tool_codes/R_lesson_youtube_2023a/第2讲 简单线性回归.R")
source("E:/zyf_gy/zyf_gy_2304_work/tool_codes/R_lesson_youtube_2023a/第2讲 简单线性回归.R")
source("E:/zyf_gy/zyf_gy_2304_work/tool_codes/R_lesson_youtube_2023a/第2讲 简单线性回归.R")
source("E:/zyf_gy/zyf_gy_2304_work/tool_codes/R_lesson_youtube_2023a/第2讲 简单线性回归.R")
source("E:/zyf_gy/zyf_gy_2304_work/tool_codes/R_lesson_youtube_2023a/第2讲 简单线性回归.R")
source("E:/zyf_gy/zyf_gy_2304_work/tool_codes/R_lesson_youtube_2023a/第2讲 简单线性回归.R")
source("E:/zyf_gy/zyf_gy_2304_work/tool_codes/R_lesson_youtube_2023a/第2讲 简单线性回归.R")
source("E:/zyf_gy/zyf_gy_2304_work/tool_codes/R_lesson_youtube_2023a/第2讲 简单线性回归.R")
source("E:/zyf_gy/zyf_gy_2304_work/tool_codes/R_lesson_youtube_2023a/第2讲 简单线性回归.R")
source("E:/zyf_gy/zyf_gy_2304_work/tool_codes/R_lesson_youtube_2023a/第2讲 简单线性回归.R")
source("E:/zyf_gy/zyf_gy_2304_work/tool_codes/R_lesson_youtube_2023a/第2讲 简单线性回归.R")
View(esti_1)
source("E:/zyf_gy/zyf_gy_2304_work/tool_codes/R_lesson_youtube_2023a/第2讲 简单线性回归.R")
source("E:/zyf_gy/zyf_gy_2304_work/tool_codes/R_lesson_youtube_2023a/第2讲 简单线性回归.R")
source("E:/zyf_gy/zyf_gy_2304_work/tool_codes/R_lesson_youtube_2023a/第2讲 简单线性回归.R")
View(predict_v1)
View(predict_v1)
source("E:/zyf_gy/zyf_gy_2304_work/tool_codes/R_lesson_youtube_2023a/第2讲 简单线性回归.R")
source("E:/zyf_gy/zyf_gy_2304_work/tool_codes/R_lesson_youtube_2023a/第2讲 简单线性回归.R")
source("E:/zyf_gy/zyf_gy_2304_work/tool_codes/R_lesson_youtube_2023a/第3讲 回归诊断.R")
source("E:/zyf_gy/zyf_gy_2304_work/tool_codes/R_lesson_youtube_2023a/第3讲 回归诊断.R")
source("E:/zyf_gy/zyf_gy_2304_work/tool_codes/R_lesson_youtube_2023a/第3讲 回归诊断.R")
source("E:/zyf_gy/zyf_gy_2304_work/tool_codes/R_lesson_youtube_2023a/第3讲 回归诊断.R")
source("E:/zyf_gy/zyf_gy_2304_work/tool_codes/R_lesson_youtube_2023a/第3讲 回归诊断.R")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
View(cor_1)
source("~/.active-rstudio-document")
chart.Correlation(multi_data, histogram = TRUE, pch = 19)
View(housing_data)
View(multi_data)
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
View(model)
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
hist(log(price))
source("~/.active-rstudio-document")
source("~/.active-rstudio-document")
#研究X变量是否都显著
summary(model)
anova(model)
model_anova$Response
model_anova <- anova(model)
model_anova$Response
model_anova$Response: log(price)
View(model_anova)
source("E:/zyf_gy/zyf_gy_2304_work/tool_codes/R_lesson_youtube_2023a/第5讲 多元线性回归.R")
model_anova['sqft.living','Sum Sq']
source("E:/zyf_gy/zyf_gy_2304_work/tool_codes/R_lesson_youtube_2023a/第5讲 多元线性回归.R")
model_anova <- anova(model)
View(model_anova)
View(model_anova)
View(model_anova)
source("E:/zyf_gy/zyf_gy_2304_work/tool_codes/R_lesson_youtube_2023a/第5讲 多元线性回归.R")
#研究X变量是否都显著
model_sum <- summary(model)
View(model_sum)
model_sum
model_sum['p-value']
pv1 <- summary(model)$fstatistic[1, 4]
View(model_sum)
pv1 <- summary(model)$fstatistic
pv1 <- summary(model)$p-value
pv1 <- summary(model)['p-value']
View(pv1)
pv1 <- summary(model)$p
#预测
model
p_value <- summary(model)$fstatistic[1, 4]
p_value <- summary(model)$fstatistic[1, 3]
p_value <- summary(model)$fstatistic
p_value <- summary(model)$fstatistic[1, 3]
print(p_value)
summary_info <- summary(model)
# Extract the p-value for the F-statistic
p_value <- summary_info$fstatistic[1, 4]
library(PerformanceAnalytics)
# Extract the p-value for the F-statistic
p_value <- summary_info$fstatistic["value", "Pr(>F)"]
View(model_sum)
# Extract the p-value for the F-statistic
p_value <- summary_info$coefficients[, "Pr(>|t|)"]
# Extract the p-value for the F-statistic
p_value <- summary_info$coefficients[, "Pr(>|t|)"]
summary_info <- summary(model)
summary_info
# Extract the p-value for the F-statistic
p_value <- summary_info$coefficients["(Intercept)", "Pr(>|t|)"]
# Extract the p-value for the F-statistic
p_value <- summary_info$coefficients[, "Pr(>|t|)"]
library(PerformanceAnalytics)
setwd("E:/zyf_gy/zyf_gy_2304_work/tool_codes/R_lesson_youtube_2023a")
housing_data <- read.csv("housing_data.csv")
multi_data = housing_data[,-1]
plot(multi_data)
cor_1 <- cor(multi_data)
chart.Correlation(multi_data, histogram = TRUE, pch = 19)
#建立多元线性回归模型
model = lm(log(price)~sqft.living+bedrooms+bathrooms,data = multi_data)
model
#回归诊断
par(mfrow=c(2,2))
plot(model)
hist(log(price))
library(PerformanceAnalytics)
setwd("E:/zyf_gy/zyf_gy_2304_work/tool_codes/R_lesson_youtube_2023a")
housing_data <- read.csv("housing_data.csv")
multi_data = housing_data[,-1]
plot(multi_data)
cor_1 <- cor(multi_data)
chart.Correlation(multi_data, histogram = TRUE, pch = 19)
#建立多元线性回归模型
model = lm(log(price)~sqft.living+bedrooms+bathrooms,data = multi_data)
model
#回归诊断
par(mfrow=c(2,2))
plot(model)
hist(log(multi_data$price))
#解释beta
par(mfrow=c(1,1))
bathrooms <- 1:10
bedrooms <- rep(mean(multi_data$bedrooms), 10)
sqft.living <- rep(mean(multi_data$sqft.living), 10)
dat.new <- data.frame(bedrooms, bathrooms, sqft.living)
plot(bathrooms, exp(predict(model, newdata=dat.new)), type="l", lwd=3, ylab="price", xlab="bedrooms", cex.lab=2)
#type="l": specifies the type of plot - line plot. lwd=3: sets the line width for the plot to 3.
#ylab="price": sets the label for the y-axis to "price. "xlab="bedrooms": sets the label for the x-axis to "bedrooms."
#cex.lab=2: adjusts the size of the axis labels.
#研究X变量是否都显著
model_sum <- summary(model)
pv1 <- summary(model)$p-value
model_anova <- anova(model)
#overall F test:
MSR = (model_anova['sqft.living','Sum Sq'] + model_anova['bedrooms','Sum Sq'] + model_anova['bs','Sum Sq'])/3 #to_be_set
MSE = model_anova['Residuals','Sum Sq'] / model_anova['Residuals','Df']
pv2 <- 1-pf(F,df1 = 3,df2 = model_anova['Residuals','Df']) #to_be_set
F = MSR/MSE
#overall F test:
MSR = (model_anova['sqft.living','Sum Sq'] + model_anova['bedrooms','Sum Sq'] + model_anova['bs','Sum Sq'])/3 #to_be_set
MSE = model_anova['Residuals','Sum Sq'] / model_anova['Residuals','Df']
F = MSR/MSE
pv2 <- 1-pf(F,df1 = 3,df2 = model_anova['Residuals','Df']) #to_be_set
#研究X变量是否都显著
model_sum <- summary(model)
pv1 <- summary(model)$p-value
model_sum <- summary(model)
model_anova <- anova(model)
model_anova
#overall F test:
MSR = (model_anova['sqft.living','Sum Sq'] + model_anova['bedrooms','Sum Sq'] + model_anova['bs','Sum Sq'])/3 #to_be_set
MSE = model_anova['Residuals','Sum Sq'] / model_anova['Residuals','Df']
F = MSR/MSE
pv2 <- 1-pf(F,df1 = 3,df2 = model_anova['Residuals','Df']) #to_be_set
model_anova['Residuals','Df']
pv2 <- 1-pf(F,df1 = 3,df2 = 6976) #to_be_set
pv2 <- 1-pf(F,df1 = 3,df2 = model_anova['Residuals','Df']) #to_be_set
pv2 <- 1-pf(F,df1 = 3,df2 = 6976) #to_be_set
print(pv2)
MSR = (882.53+10.40+4.38)/3
MSE = 1042.99/6976
F = MSR/MSE
pv2b <- 1-pf(F,df1=3,df2=6976)
#overall F test:
model_anova_v1 = model_anova['sqft.living','Sum Sq']
MSE = model_anova['Residuals','Sum Sq'] / model_anova['Residuals','Df']
MSR = (882.53+10.40+4.38)/3
MSE = 1042.99/6976
F = MSR/MSE
pv2 <- 1-pf(F,df1 = 3,df2 = 6976) #to_be_set
MSR = (model_anova['sqft.living','Sum Sq'] + model_anova['bedrooms','Sum Sq'] + model_anova['bs','Sum Sq'])/3 #to_be_set
MSE = model_anova['Residuals','Sum Sq'] / model_anova['Residuals','Df']
F = MSR/MSE
pv2 <- 1-pf(F,df1 = 3,df2 = 6976) #to_be_set
MSR = (model_anova['sqft.living','Sum Sq'] + model_anova['bedrooms','Sum Sq'] + model_anova['bs','Sum Sq'])/3 #to_be_set
MSR = (model_anova['sqft.living','Sum Sq'] + model_anova['bedrooms','Sum Sq'] + model_anova['bathrooms','Sum Sq'])/3 #to_be_set
MSE = model_anova['Residuals','Sum Sq'] / model_anova['Residuals','Df']
F = MSR/MSE
pv2 <- 1-pf(F,df1 = 3,df2 = 6976) #to_be_set
model
x = data.frame(sqft.living=1000, bedrooms=3, bathrooms=3)
exp(predict(model,x,interval="confidence"))
#2）VIF 方差膨胀系数(variance inflation factor)
partial.regrs =lm(sqft.living ~ bedrooms+bathrooms,data=multi_data )
summary(partial.regrs)
pr_sum <- summary(partial.regrs)
View(pr_sum)
pr_sum$r.squared
VIF_1 <- 1/(1-pr_sum$r.squared)
#install.packages("car")
library(car)
vif(model)
exp(predict(model,x) #点估计
vif(model)
vif(model)
library(PerformanceAnalytics)
setwd("E:/zyf_gy/zyf_gy_2304_work/tool_codes/R_lesson_youtube_2023a")
data_1 <- read.csv("data_1.csv")
library(PerformanceAnalytics)
setwd("E:/zyf_gy/zyf_gy_2304_work/tool_codes/R_lesson_youtube_2023a")
data_1 <- read.csv("housing_data.csv")
data_2 = data_1[,-1]
plot(data_2)
cor_1 <- cor(data_2)
library(PerformanceAnalytics)
#input data
setwd("E:/zyf_gy/zyf_gy_2304_work/tool_codes/R_lesson_youtube_2023a")
data_1 <- read.csv("housing_data.csv")
data_2 = data_1[,-1]
#correlation table
cor_1 <- cor(data_2)
#plot data
plot(data_2)
chart.Correlation(data_2, histogram = TRUE, pch = 19)
library(PerformanceAnalytics)
#input data
setwd("E:/zyf_gy/zyf_gy_2304_work/tool_codes/R_lesson_youtube_2023a")
data_1 <- read.csv("housing_data.csv")
data_2 = data_1[,-1]
#correlation table
cor_1 <- cor(data_2)
#plot data
plot(data_2)
chart.Correlation(data_2, histogram = TRUE, pch = 19)
#建立多元线性回归模型
model = lm(log(price)~sqft.living+bedrooms+bathrooms,data = multi.data)
View(data_2)
source("~/.active-rstudio-document")
library(PerformanceAnalytics)
#input data
setwd("E:/zyf_gy/zyf_gy_2304_work/tool_codes/R_lesson_youtube_2023a")
data_1 <- read.csv("housing_data.csv")
data_2 = data_1[,-1]
#correlation table
cor_1 <- cor(data_2)
#plot data
plot(data_2)
chart.Correlation(data_2, method = "pearson", pch = 19, col = "blue", tl.cex = 1.2)
#build multiple linear model
model = lm(log(price)~sqft.living+bedrooms+bathrooms,data = multi.data)
#build multiple linear model
model = lm(log(price)~sqft.living+bedrooms+bathrooms,data = data_2)
model
#回归诊断
par(mfrow=c(2,2))
plot(model)
hist(log(data_2$price))
par(mfrow=c(1,1))
bathrooms <- 1:10
bedrooms <- rep(mean(data_2$bedrooms), 10)
sqft.living <- rep(mean(data_2$sqft.living), 10)
dat.new <- data.frame(bedrooms, bathrooms, sqft.living)
plot(bathrooms, exp(predict(model, newdata=dat.new)), type="l", lwd=3, ylab="price", xlab="bedrooms", cex.lab=2)
source("E:/zyf_gy/zyf_gy_2304_work/tool_codes/R_lesson_youtube_2023a/第1讲 初始R studio_up2023_0925.R")
source("E:/zyf_gy/zyf_gy_2304_work/tool_codes_k2/R_lesson_youtube_2023a/第1讲 初始R studio_up2023_0925.R")
source("E:/zyf_gy/zyf_gy_2304_work/tool_codes_k2/R_lesson_youtube_2023a/第1讲 初始R studio_up2023_0925.R")
View(data_1)
View(student_data)
View(data_1_tail)
data_1_sum
View(data_2)
View(data_1)
source("E:/zyf_gy/zyf_gy_2304_work/tool_codes_k2/R_lesson_youtube_2023a/第1讲 初始R studio_up2023_0925.R")
source("E:/zyf_gy/zyf_gy_2304_work/tool_codes_k2/R_lesson_youtube_2023a/第1讲 初始R studio_up2023_0925.R")
View(data_1)
View(data_1_tail)
data_1_sum
View(data_2)
View(data_1)
data_2_sum
source("E:/zyf_gy/zyf_gy_2304_work/tool_codes_k2/R_lesson_youtube_2023a/第1讲 初始R studio_up2023_0925.R")
View(student_data)
View(data_1)
View(data_1_tail)
View(data_1_tail)
data_1_sum
data_2_sum
View(data_2)
View(data_1)
source("E:/zyf_gy/zyf_gy_2304_work/tool_codes_k2/R_lesson_youtube_2023a/第2讲 简单线性回归_up2023_0925.R")
source("E:/zyf_gy/zyf_gy_2304_work/tool_codes_k2/R_lesson_youtube_2023a/第2讲 简单线性回归_up2023_0925.R")
View(student_data)
View(data)
View(lm_data)
View(data)
source("E:/zyf_gy/zyf_gy_2304_work/tool_codes_k2/R_lesson_youtube_2023a/第2讲 简单线性回归_up2023_0925.R")
View(model_anova)
View(model_anova)
source("E:/zyf_gy/zyf_gy_2304_work/tool_codes_k2/R_lesson_youtube_2023a/第3讲 回归诊断_up2023_0925.R")
source("E:/zyf_gy/zyf_gy_2304_work/tool_codes_k2/R_lesson_youtube_2023a/第5讲 多元线性回归_up2023_0925.R")
model_anova <- anova(model)
model_anova
source("E:/zyf_gy/zyf_gy_2304_work/tool_codes_k2/R_lesson_youtube_2023a/第5讲 多元线性回归.R")
model_anova
source("E:/zyf_gy/zyf_gy_2304_work/tool_codes_k2/R_lesson_youtube_2023a/第5讲 多元线性回归_up2023_0925.R")
View(data_2)
